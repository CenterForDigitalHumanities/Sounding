<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="../brokenBooks/css/brokenbooks.css">	
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>  
        <script src="http://localhost:8080/brokenBooks/js/bb.js"></script>  
        <title>Sort Breviary Order</title>
        <style>
            .mainBlock{
                background-color:white;
            }
            p{
                color: black;
            }
            .rangeArrangementArea{ /* Force each area to be the same height in this case. */
                height: 400px;
                z-index: 2;
            }
            .arrangeSection{
                z-index: 2;
            }
            .arrangeSection div{
                z-index: 1;
            }
            div[leaf="true"]{
                display: block;
                border: 2px solid black;
            }
            .child .child{
                display: none;
            }
            .parent .child{
                display: none;
            }
            .unassigned .child{ /* This will hide leaves sitting in the unassigned areas. */
                display: none !important;
            }
            .unassigned .parent{ /* This will hide leaves sitting in the unassigned areas. */
                display: none !important;
            }
            .unassigned{
                padding: 8px 32px 8px 8px !important;
            }
            .notBucket{
                padding: 4px 4px 45px 4px;
                border: 1px solid red;
                margin-bottom: 5px;
            }

            div[relation="bucket"] {
                display: inline-table;
                border-right: 2px solid black;
                border-left: transparent;
                border-top: transparent;
                border-bottom: transparent;
            }
            
        </style>
    </head>
    <body>
        <div class="mainBlock">
            <p>
                    This interface allows you to order the breviary.  
                    Click and drag sections to move them from one place to another.
                    You can create new sections and give them labels.  You cannot create leaves here. 

                    You may be able to lock leaves together to force the start or end of a section to allow for content flow. 
                    For more information about defining a leaf as the start or end of a section <a href="#">click here</a>
            </p>
            <div class="arrangeTrail">
                <div class="rangeArrangementArea" depth = "1" rangeID="bucket">
                   <div ondragover='dragOverHelp(event);' ondrop='dropHelp(event);' class="notBucket"></div>
                   <div rangeID="bucket" onclick='toggleChildren($(this), "admin");' class="arrangeSection parent unassigned sortOrder">Bucket</div>
                   <input class="makeGroup" value="Make Group" type="button" onclick="askForNewTitle($(this).parent());"/>
                   <input class="makeSortable" value="Sort" type="button" onclick="makeSortable($(this).parent());"/><input class="doneSortable" value="Done" type="button" onclick="stopSorting($(this).parent());"/>
                </div>
            </div>
        </div>
    </body>
    <script>

    function makeSortable(column){
        //Will sortable overrule draggable? 
        var columnDepth = column.attr("depth");
        column.children('.notBucket').sortable({helper:'clone'});
        $.each($(".rangeArrangementArea").not(".rangeArrangementArea[depth='"+columnDepth+"']"), function(){
            var overDiv = $("<div class='areaCover'></div>");
            console.log("Append over div to");
            console.log($(this));
            $(this).append(overDiv);
        });
        column.children(".makeSortable").hide();
        column.children(".doneSortable").show();
    }
    function stopSorting(column){
        column.children(".notBucket").sortable("destroy");
        $(".areaCover").remove();
        column.children(".makeSortable").show();
        column.children(".doneSortable").hide();
    }

        $(function(){
            //NOTE: THIS SHOULD ONLY WORK FOR ADMINS
            gatherRangesForArrange(2);
            
            
        });
    </script>
</html>
